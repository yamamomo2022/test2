Sub CalculateStress()
    ' 入力値の取得
    Dim force As Double
    Dim area As Double
    Dim stress As Double
    
    force = InputBox("力 (N) を入力してください:")
    area = InputBox("断面積 (m^2) を入力してください:")
    
    ' 応力の計算
    stress = force / area
    
    ' 結果の表示
    MsgBox "応力: " & stress & " Pa"
End Sub

Sub CalculateDeflection()
    ' 入力値の取得
    Dim length As Double
    Dim modulus As Double
    Dim inertia As Double
    Dim load As Double
    
    length = InputBox("梁の長さ (m) を入力してください:")
    modulus = InputBox("ヤング率 (Pa) を入力してください:")
    inertia = InputBox("断面二次モーメント (m^4) を入力してください:")
    load = InputBox("集中荷重 (N) を入力してください:")
    
    ' たわみの計算
    Dim x As Double
    Dim deflection As Double
    Dim stepSize As Double
    
    x = 0
    stepSize = 0.001 ' xの刻み幅
    
    Do While x <= length
        ' たわみの計算（梁の曲げ方程式に基づく）
        deflection = (load * x ^ 2) / (6 * modulus * inertia) * (3 * length - x)
        
        ' 結果の表示
        Debug.Print "x = " & x & ", たわみ = " & deflection
        
        x = x + stepSize
    Loop
End Sub

# https://thom.hateblo.jp/entry/2021/01/09/122956
Option Explicit
Sub MohrsStressCircle()
    Const A0 = 150
    Const P = 300
    Dim θ As Double
    
    Dim r As Range: Set r = ThisWorkbook.Sheets(1).Range("A1")
    r.Value = "σ"
    r.Offset(0, 1).Value = "τ"
    
    For θ = -90 To 90 Step 1
        Set r = r.Offset(1, 0)
        
        Dim Pn: Pn = P * Cos(Radian(θ))
        Dim Ps: Ps = P * Sin(Radian(θ))
        Dim σ: σ = Pn / (A0 / Cos(Radian(θ)))
        Dim τ: τ = Ps / (A0 / Cos(Radian(θ)))
        
        r.Value = σ
        r.Offset(0, 1).Value = τ
    Next
End Sub

Function Radian(degree As Double) As Double
    Const π = 3.14159265359
    Radian = degree * (π / 180)
End Function

https://github.com/yamamomo2022
