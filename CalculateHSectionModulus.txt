Sub CalculateHSectionModulus()
    ' 変数を定義
    Dim bf As Double ' フランジの幅
    Dim h As Double ' 全高
    Dim tw As Double ' ウェブの厚さ
    Dim tf As Double ' フランジの厚さ
    Dim Ix As Double ' X軸周りの断面二次モーメント
    Dim Iy As Double ' Y軸周りの断面二次モーメント

    ' セルからH形鋼の寸法を読み取る
    bf = Range("A1").Value ' A1セルにフランジの幅を入力
    h = Range("A2").Value ' A2セルに全高を入力
    tw = Range("A3").Value ' A3セルにウェブの厚さを入力
    tf = Range("A4").Value ' A4セルにフランジの厚さを入力

    ' 断面二次モーメントの計算
    Ix = ((bf * h ^ 3) - (bf - tw) * (h - 2 * tf) ^ 3) / 12
    Iy = (2 * (tf * bf ^ 3) + (h - 2 * tf) * tw ^ 3) / 12

    ' 結果をセルに出力
    Range("A5").Value = Ix ' A5セルにX軸周りの断面二次モーメントを出力
    Range("A6").Value = Iy ' A6セルにY軸周りの断面二次モーメントを出力
End Sub
